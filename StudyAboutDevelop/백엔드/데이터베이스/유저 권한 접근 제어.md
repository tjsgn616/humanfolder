<<<유저, 메뉴, 권한.  Grant Revoke, 비트 연산, 플래그>>
https://okky.kr/article/704905

1. 회원, 역할, 권한, 메뉴, 프로그램
가장 많이 쓰고 추천하는 모델 : 역할기반 인증(Role Based Authentication)
[참고](http://www.darwinbiler.com/role-based-access-control-erd/)

## 이력은 어떻게 관리할래?





---
1. 기존 설계()
기능마다 필드(컬럼)을 두어 1,0 형식으로 저장.
장점 : 직관적이다.
단점 : 필드가 많아진다.
      확장을 하려면 데이터가 아닌 필드를 추가해야한다. 즉, 새로운 권한이 추가될때마다 계속 db를 수정해야함.


2. 기능코드 테이블을 따로만들고 fk로 추가한 설계
장점 : 확장이 용이하다.
단점 :

권한마다 2의 n승 꼴로나타낼수 있는 고유숫자를 붙여준다음 비트 논리합연산. -> 1이면 그 권한을 갖고있는 것.

Q1. Revoke 와 Grant가 동시에 작용된다면 무엇을 우선해야하는가?

예1)        rwx(읽기, 쓰기, 실행)에 대하여
    user는  111
    group은 000
    other는 100
예2) 자유 게시판, 동영상 게시판, 사진게시판, 자료게시판, 투표 게시판 등이 있다고 치자.
     <권한>은 총관리자, 매니저, 정회원, 준회원, 미회원이 있다고 치자.
     <역할. role>은 읽기, 쓰기, 수정, 삭제.    특수기능 : 매니저 지정
     <기능>은 글 목록 조회, 글 검색, 글의 상세내용 조회, 글 등록, 글 수정, 글 삭제
     아.. 용어가 너무 헷갈린다. 기능별로 권한이 생기는것 아닌가. 글의 목록을 조회할수있는 권한. 글을 검색할수 있는 권한 같이.
     총관리자는 모든권한을 가지고있고 매니저를 지정할수도, 모든 글을 삭제할수도있다. 단, 남의 글을 수정하는 것은 안된다.
     매니저는 자기 담당 커뮤니티에서는 모든 권한.
     정회원은 담당 커뮤니티의 글쓰기, 자기글 수정삭제까지.
     준회원은 읽기까지
     미회원은 아무것도 없다고 치자.


팁1 : 사실 권한은 프로그램에 딸려야지 메뉴에 딸리면 안된다. 집으로 가는길이 3군데야. 어느길로 가면 문이 열리고 이러면 말이 안되지.
팁2 : Security = 인증 + 인가
      인증=Authentication.   너는 진짜 너인가?
      인가 = 자원에 대한 권한. 자원에 대한 접근을 허가.
팁3 : 정규화의 판단기준은 합목적성. 상품의 단가가 상품 테이블의 컬럼으로 있어야될까? 따로 때야될까?    해당상품의 가격은 현시점 최종단가로 모든 가격을 결정하겠다하면 해당 테이블로 있어야하는거고.? 고객의 요구사항에 따라 다른거다.
            단가가 바뀌면 새로운 상품id를 따기로 했다고 하자. 상품분류가 사실 우리가 인지하는 상품이고. 그러면 상품에서 단가를 관리하는게 맞다.

추가숙제 : 인증 성공, 인증 실패에 대한 후처리
권한 실패시 처리 다양화
인증정보의 외부화
자동 로그인, 다양한 로그인, 세션제어
Spring Security Role Hierachy.   하위권한 자동 설정

팝업에 대한 권한 처리하려면 어떻게 하면 좋을지
Role, Privilage, Rule등 공부

<접근제어의 요소>
주제 : 사용자, 프로세스
객체 : 파일, 데이터베이스, 프로그램
접근(주체가 객체를 사용하는 것) : 읽기, 쓰기, 변경, 삭제, 실행

Talnet, SSH, FTP, Terminal 등이 운영체제의 접근제어
윈도우NT4.0부터 NTFS파일 시스템 사용. 이 시스템에서는 보안 설정에 사용자별로 사용권한을 제한할 수 있다.
데이터베이스의 권한관리는 DCL(Data Control Language). Grant, Deny, Revoke가 있다.


<tip1> 유저테이블에 유저아이디를 키로잡을경우의 문제
     사용자가 탈퇴를 하면 탈퇴한 사용자 정보는 어떻게 할건가?
     탈퇴한 사용자의 아이디로 그후에 가입한 사용자가 사용하려고 하면 어떻게 되는가?
     이럴경우 사용자 아이디로 검색하면 예전에 아이디 주인이 썼던 글이 검색되지 않겠는가. 그래서 시퀀스로 회원번호 같은것을 키로하는것이 좋다.
<tip2> 비밀번호나 주민번호같은 개인정보를 보관할때는 해쉬알고리즘을 사용하든가 해야지 암호화만으로 끝내지 말아야 한다. 암호화 한다는 말은 복호화가 가능하다는 말과 동일하다.
<tip3> 컬럼에 숫자를 쓰는 일은 없도록 하자. 컬럼명만 보고도 어떤테이블과 관계를 맺고 있는지 유추가 가능해야 한다.
